# ArmorIQ SDK - Visual Flow & Architecture

**Complete System Flow Visualization**

---

## ğŸ¯ High-Level Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER APPLICATION                          â”‚
â”‚                    (Your Python Code)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Import & Initialize
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ARMORIQ SDK v0.1.1                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Client API                                                 â”‚  â”‚
â”‚  â”‚  â€¢ capture_plan()     â€¢ get_intent_token()                 â”‚  â”‚
â”‚  â”‚  â€¢ invoke()           â€¢ delegate()                          â”‚  â”‚
â”‚  â”‚  â€¢ execute_plan()     â€¢ generate_proof()                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                  â”‚                 â”‚                  â”‚
     â”‚ Register         â”‚ Get Token       â”‚ Execute          â”‚ Discover
     â”‚ Agent           â”‚ (Security)      â”‚ Action           â”‚ MCPs
     â–¼                  â–¼                 â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ConMap  â”‚      â”‚   IAP    â”‚      â”‚  Proxy   â”‚      â”‚  MCPs   â”‚
â”‚  Auto   â”‚      â”‚ (CSRG)   â”‚      â”‚  Server  â”‚      â”‚ Various â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                  â”‚                 â”‚                  â”‚
     â”‚                  â”‚                 â”‚                  â”‚
Production Endpoints:   â”‚                 â”‚                  â”‚
â€¢ api.armoriq.io       â”‚                 â”‚                  â”‚
â€¢ iap.armoriq.io â”€â”€â”€â”€â”€â”€â”˜                 â”‚                  â”‚
â€¢ cloud-run-proxy.armoriq.io â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â€¢ <your-mcp-servers> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Complete Execution Flow

### Step 1: Plan Capture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Code                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  with client.capture_plan() as plan:                         â”‚
â”‚      plan.think("Check loan eligibility")                    â”‚
â”‚      plan.tool_call("loan-mcp", "check", {...})              â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Builds reasoning graph
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Plan Object (in memory)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                             â”‚
â”‚   "goal": "Check loan eligibility",                          â”‚
â”‚   "steps": [                                                  â”‚
â”‚     {                                                         â”‚
â”‚       "type": "think",                                        â”‚
â”‚       "content": "Check loan eligibility"                    â”‚
â”‚     },                                                        â”‚
â”‚     {                                                         â”‚
â”‚       "type": "tool_call",                                    â”‚
â”‚       "mcp": "loan-mcp",                                      â”‚
â”‚       "tool": "check",                                        â”‚
â”‚       "params": {...}                                         â”‚
â”‚     }                                                         â”‚
â”‚   ]                                                           â”‚
â”‚ }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 2: Token Issuance (IAP)

```
SDK                         IAP (iap.armoriq.io)
 â”‚                               â”‚
 â”‚ POST /intent                  â”‚
 â”‚ { plan, user_id, agent_id }   â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                               â”‚
 â”‚                               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                               â”‚ â”‚ 1. Receive Plan     â”‚
 â”‚                               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚                               â”‚           â”‚
 â”‚                               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                               â”‚ â”‚ 2. CSRG             â”‚
 â”‚                               â”‚ â”‚    Canonicalize     â”‚
 â”‚                               â”‚ â”‚    (standardize)    â”‚
 â”‚                               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚                               â”‚           â”‚
 â”‚                               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                               â”‚ â”‚ 3. Build Merkle     â”‚
 â”‚                               â”‚ â”‚    Tree of steps    â”‚
 â”‚                               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚                               â”‚           â”‚
 â”‚                               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚                               â”‚ â”‚ 4. Sign with        â”‚
 â”‚                               â”‚ â”‚    Ed25519 key      â”‚
 â”‚                               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚                               â”‚           â”‚
 â”‚   Intent Token Response       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚   {                           â”‚ â”‚ 5. Return Token     â”‚
 â”‚     intent_reference: "...",  â”‚ â”‚    + Signature      â”‚
 â”‚     signature: "...",         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚     merkle_root: "...",       â”‚           â”‚
 â”‚     expires_at: "..."         â”‚           â”‚
 â”‚   }                           â”‚           â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â”‚                               â”‚
 â”‚ Token received! âœ…            â”‚
 â”‚                               â”‚
```

### Step 3: Action Execution (Proxy)

```
SDK                    Proxy                         IAP              MCP
 â”‚                      â”‚                            â”‚                â”‚
 â”‚ POST /invoke         â”‚                            â”‚                â”‚
 â”‚ {                    â”‚                            â”‚                â”‚
 â”‚   token: "...",      â”‚                            â”‚                â”‚
 â”‚   action: {          â”‚                            â”‚                â”‚
 â”‚     mcp: "loan-mcp", â”‚                            â”‚                â”‚
 â”‚     tool: "check",   â”‚                            â”‚                â”‚
 â”‚     params: {...}    â”‚                            â”‚                â”‚
 â”‚   }                  â”‚                            â”‚                â”‚
 â”‚ }                    â”‚                            â”‚                â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚                â”‚
 â”‚                      â”‚                            â”‚                â”‚
 â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
 â”‚                      â”‚ â”‚ 1. Receive Request   â”‚  â”‚                â”‚
 â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
 â”‚                      â”‚ â”‚ 2. Extract Token     â”‚  â”‚                â”‚
 â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚            â”‚ POST /verify/action           â”‚
 â”‚                      â”‚            â”‚ { token, action }             â”‚
 â”‚                      â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚ Verify signatureâ”‚
 â”‚                      â”‚            â”‚              â”‚ Check action   â”‚
 â”‚                      â”‚            â”‚              â”‚ matches plan   â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚            â”‚  Valid: true â”‚                â”‚
 â”‚                      â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
 â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
 â”‚                      â”‚ â”‚ 3. Action Verified âœ… â”‚  â”‚                â”‚
 â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
 â”‚                      â”‚ â”‚ 4. Route to MCP      â”‚  â”‚                â”‚
 â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚            â”‚ POST /tools/check             â”‚
 â”‚                      â”‚            â”‚ { params: {...} }             â”‚
 â”‚                      â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚  Execute logic â”‚
 â”‚                      â”‚            â”‚              â”‚  (check loan)  â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚                      â”‚            â”‚   Result: {...}               â”‚
 â”‚                      â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
 â”‚                      â”‚ â”‚ 5. Add to Audit Log  â”‚  â”‚                â”‚
 â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                â”‚
 â”‚                      â”‚            â”‚              â”‚                â”‚
 â”‚   Response: {        â”‚            â”‚              â”‚                â”‚
 â”‚     status: "ok",    â”‚            â”‚              â”‚                â”‚
 â”‚     result: {...},   â”‚            â”‚              â”‚                â”‚
 â”‚     audit_id: "..."  â”‚            â”‚              â”‚                â”‚
 â”‚   }                  â”‚            â”‚              â”‚                â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                â”‚
 â”‚                      â”‚                            â”‚                â”‚
 â”‚ Action completed! âœ… â”‚                            â”‚                â”‚
 â”‚                      â”‚                            â”‚                â”‚
```

---

## ğŸ¤ Agent-to-Agent Delegation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Primary Agent (Finance Agent)               â”‚
â”‚                          user: "alice"                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 1. Create delegation
                             â”‚    to_agent: "risk-agent"
                             â”‚    capabilities: ["calculate_risk"]
                             â”‚    expires: 3600 seconds
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚       IAP          â”‚
                    â”‚  POST /delegation/ â”‚
                    â”‚       create       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Returns delegation token
                             â”‚ with capabilities + expiry
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Delegation Token (Cryptographically Signed)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                                â”‚
â”‚   "from_agent": "finance-agent",                                â”‚
â”‚   "to_agent": "risk-agent",                                     â”‚
â”‚   "user": "alice",                                              â”‚
â”‚   "capabilities": ["calculate_risk"],                           â”‚
â”‚   "expires_at": "2026-01-16T15:35:00Z",                        â”‚
â”‚   "delegation_chain": ["finance-agent"],                        â”‚
â”‚   "signature": "..."                                            â”‚
â”‚ }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Pass to sub-agent
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Secondary Agent (Risk Agent)                      â”‚
â”‚                   uses delegation_token                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ 2. Risk agent acts with
                             â”‚    delegated authority
                             â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                         â”‚  IAP  â”‚ Verifies:
                         â”‚       â”‚ âœ… Signature valid
                         â”‚       â”‚ âœ… Not expired
                         â”‚       â”‚ âœ… Capability matches
                         â”‚       â”‚ âœ… Chain intact
                         â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                             â”‚
                             â”‚ Token validated âœ…
                             â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Proxy â”‚ Routes action
                         â”‚       â”‚ with full audit trail
                         â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                             â”‚
                             â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Risk MCPâ”‚ Executes
                        â”‚         â”‚ calculate_risk
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AUDIT TRAIL SHOWS:
â”œâ”€ Original user: "alice"
â”œâ”€ Primary agent: "finance-agent"
â”œâ”€ Delegated to: "risk-agent"
â”œâ”€ Action: "calculate_risk"
â”œâ”€ Authority chain: alice â†’ finance-agent â†’ risk-agent
â””â”€ Complete traceability âœ…
```

---

## ğŸŒ Multi-MCP Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Travel Planning Agent                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”‚ Creates complex plan with multiple MCPs
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Plan Object                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Step 1: Flight Search      â†’ flight-mcp.search()                â”‚
â”‚ Step 2: Hotel Search       â†’ hotel-mcp.search()                 â”‚
â”‚ Step 3: Calculate Budget   â†’ finance-mcp.calculate()            â”‚
â”‚ Step 4: Book Flight        â†’ flight-mcp.book()                  â”‚
â”‚ Step 5: Book Hotel         â†’ hotel-mcp.book()                   â”‚
â”‚ Step 6: Process Payment    â†’ payment-mcp.charge()               â”‚
â”‚ Step 7: Send Confirmation  â†’ notification-mcp.send()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Get single token for entire plan
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      IAP       â”‚ Issues ONE token
                    â”‚                â”‚ for ALL steps
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Token covers entire workflow
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Proxy                                 â”‚
â”‚                  (Routes to different MCPs)                      â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚        â”‚        â”‚        â”‚        â”‚        â”‚        â”‚
   â”‚ Step 1 â”‚ Step 2 â”‚ Step 3 â”‚ Step 4 â”‚ Step 5 â”‚ Step 6 â”‚ Step 7
   â–¼        â–¼        â–¼        â–¼        â–¼        â–¼        â–¼
â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”
â”‚Flgtâ”‚  â”‚Hotlâ”‚  â”‚Finnâ”‚  â”‚Flgtâ”‚  â”‚Hotlâ”‚  â”‚Paymâ”‚  â”‚Notfâ”‚
â”‚MCP â”‚  â”‚MCP â”‚  â”‚MCP â”‚  â”‚MCP â”‚  â”‚MCP â”‚  â”‚MCP â”‚  â”‚MCP â”‚
â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜

Each MCP verifies token with IAP before executing âœ…
Complete audit trail maintained across all MCPs âœ…
```

---

## ğŸ” Security & Verification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Security Layers                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: CSRG Canonicalization
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Original Plan â†’ Canonical Form                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ User Input â”‚ â”€â”€â”€> â”‚ Normalized â”‚                            â”‚
â”‚  â”‚ (varies)   â”‚      â”‚ (standard) â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚  â€¢ Removes whitespace                                           â”‚
â”‚  â€¢ Standardizes JSON keys                                       â”‚
â”‚  â€¢ Sorts arrays deterministically                               â”‚
â”‚  â€¢ Same input = same canonical form                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 2: Merkle Tree
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Merkle Root (single hash)                           â”‚
â”‚                       â”‚                                          â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚           â”‚                       â”‚                             â”‚
â”‚      Hash(1+2)                Hash(3+4)                         â”‚
â”‚           â”‚                       â”‚                             â”‚
â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                        â”‚
â”‚      â”‚         â”‚            â”‚         â”‚                        â”‚
â”‚  Hash(1)   Hash(2)      Hash(3)   Hash(4)                      â”‚
â”‚      â”‚         â”‚            â”‚         â”‚                        â”‚
â”‚   Step 1    Step 2       Step 3    Step 4                      â”‚
â”‚                                                                  â”‚
â”‚  â€¢ Each step hashed                                             â”‚
â”‚  â€¢ Paired hashes combined                                       â”‚
â”‚  â€¢ Root proves all steps                                        â”‚
â”‚  â€¢ Can prove individual step with path                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 3: Ed25519 Signature
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Signature = Sign(Merkle_Root + Metadata, Private_Key)          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚ Merkle Root  â”‚      â”‚  Private Key â”‚                        â”‚
â”‚  â”‚ + User ID    â”‚  +   â”‚    (IAP)     â”‚  = Signature           â”‚
â”‚  â”‚ + Timestamp  â”‚      â”‚              â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                  â”‚
â”‚  Anyone can verify with:                                        â”‚
â”‚  Verify(Signature, Merkle_Root, Public_Key) â†’ true/false       â”‚
â”‚                                                                  â”‚
â”‚  â€¢ Unforgeable (can't create without private key)              â”‚
â”‚  â€¢ Non-repudiable (IAP can't deny signing)                     â”‚
â”‚  â€¢ Tamper-proof (any change invalidates signature)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 4: Action Verification
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  When action executed:                                           â”‚
â”‚                                                                  â”‚
â”‚  1. Extract action from request                                 â”‚
â”‚  2. Hash the action                                             â”‚
â”‚  3. Find hash in Merkle tree                                    â”‚
â”‚  4. Verify Merkle path to root                                  â”‚
â”‚  5. Verify signature on root                                    â”‚
â”‚                                                                  â”‚
â”‚  âœ… Action matches plan                                         â”‚
â”‚  âœ… Plan was properly signed                                    â”‚
â”‚  âœ… Token not expired                                           â”‚
â”‚  âœ… Signature valid                                             â”‚
â”‚                                                                  â”‚
â”‚  â†’ Action APPROVED                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Complete Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USER APPLICATION                               â”‚
â”‚                                                                   â”‚
â”‚  loan_agent = ArmorIQClient(                                     â”‚
â”‚      user_id="alice@company.com",                                â”‚
â”‚      agent_id="loan-processor"                                   â”‚
â”‚  )                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SDK INITIALIZATION                           â”‚
â”‚                                                                   â”‚
â”‚  1. Load production endpoints:                                   â”‚
â”‚     â€¢ IAP: https://iap.armoriq.io                               â”‚
â”‚     â€¢ Proxy: https://cloud-run-proxy.armoriq.io                 â”‚
â”‚     â€¢ ConMap: https://api.armoriq.io                            â”‚
â”‚                                                                   â”‚
â”‚  2. Register with ConMap (optional):                             â”‚
â”‚     POST /agents/register                                        â”‚
â”‚     { agent_id, capabilities, endpoint }                         â”‚
â”‚                                                                   â”‚
â”‚  3. Initialize HTTP client with:                                 â”‚
â”‚     â€¢ Retry logic                                                â”‚
â”‚     â€¢ Timeout settings                                           â”‚
â”‚     â€¢ Error handling                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PLAN CAPTURE                                 â”‚
â”‚                                                                   â”‚
â”‚  with loan_agent.capture_plan() as plan:                         â”‚
â”‚      plan.think("Check customer eligibility")                    â”‚
â”‚      plan.tool_call("credit-mcp", "check_score", {...})          â”‚
â”‚      plan.tool_call("loan-mcp", "calculate_rate", {...})         â”‚
â”‚                                                                   â”‚
â”‚  Builds in-memory graph:                                         â”‚
â”‚  PlanCapture {                                                   â”‚
â”‚    goal: "Check customer eligibility"                            â”‚
â”‚    steps: [ThinkStep, ToolCallStep, ToolCallStep]                â”‚
â”‚    observations: {}                                              â”‚
â”‚  }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GET INTENT TOKEN                               â”‚
â”‚                                                                   â”‚
â”‚  token = loan_agent.get_intent_token()                           â”‚
â”‚                                                                   â”‚
â”‚  SDK â†’ IAP:                                                      â”‚
â”‚  POST https://iap.armoriq.io/intent                              â”‚
â”‚  {                                                                â”‚
â”‚    "plan": { /* canonical plan */ },                             â”‚
â”‚    "policy": { /* access rules */ },                             â”‚
â”‚    "identity": {                                                 â”‚
â”‚      "user_id": "alice@company.com",                             â”‚
â”‚      "agent_id": "loan-processor"                                â”‚
â”‚    }                                                              â”‚
â”‚  }                                                                â”‚
â”‚                                                                   â”‚
â”‚  IAP â†’ SDK:                                                      â”‚
â”‚  {                                                                â”‚
â”‚    "intent_reference": "csrg_...",                               â”‚
â”‚    "signature": "base64_ed25519_sig",                            â”‚
â”‚    "merkle_root": "...",                                         â”‚
â”‚    "expires_at": "2026-01-16T15:35:00Z"                         â”‚
â”‚  }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXECUTE ACTION                                 â”‚
â”‚                                                                   â”‚
â”‚  result = loan_agent.invoke(                                     â”‚
â”‚      "credit-mcp",                                               â”‚
â”‚      "check_score",                                              â”‚
â”‚      {"customer_id": "CUST_001"}                                 â”‚
â”‚  )                                                                â”‚
â”‚                                                                   â”‚
â”‚  SDK â†’ Proxy:                                                    â”‚
â”‚  POST https://cloud-run-proxy.armoriq.io/invoke                  â”‚
â”‚  {                                                                â”‚
â”‚    "token": "csrg_...",                                          â”‚
â”‚    "action": {                                                   â”‚
â”‚      "mcp": "credit-mcp",                                        â”‚
â”‚      "tool": "check_score",                                      â”‚
â”‚      "params": {"customer_id": "CUST_001"}                       â”‚
â”‚    }                                                              â”‚
â”‚  }                                                                â”‚
â”‚                                                                   â”‚
â”‚  Proxy verifies with IAP â†’ Routes to MCP â†’ Returns result        â”‚
â”‚                                                                   â”‚
â”‚  Result: {                                                       â”‚
â”‚    "status": "success",                                          â”‚
â”‚    "data": { "score": 720, "risk": "low" },                     â”‚
â”‚    "audit_id": "audit_123",                                      â”‚
â”‚    "execution_time_ms": 145                                      â”‚
â”‚  }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AUDIT TRAIL                                  â”‚
â”‚                                                                   â”‚
â”‚  Immutable log stored in IAP:                                    â”‚
â”‚  {                                                                â”‚
â”‚    "timestamp": "2026-01-16T14:35:12Z",                          â”‚
â”‚    "user_id": "alice@company.com",                               â”‚
â”‚    "agent_id": "loan-processor",                                 â”‚
â”‚    "intent_reference": "csrg_...",                               â”‚
â”‚    "action": "credit-mcp.check_score",                           â”‚
â”‚    "params_hash": "sha256_...",                                  â”‚
â”‚    "result_hash": "sha256_...",                                  â”‚
â”‚    "merkle_proof": [...],                                        â”‚
â”‚    "signature_verified": true,                                   â”‚
â”‚    "execution_time_ms": 145                                      â”‚
â”‚  }                                                                â”‚
â”‚                                                                   â”‚
â”‚  Queryable for compliance & debugging âœ…                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Features Highlighted

### 1. Automatic Everything
- âœ… Security (Ed25519 + CSRG)
- âœ… Routing (Proxy finds MCP)
- âœ… Verification (IAP validates)
- âœ… Audit (Logs everything)

### 2. Developer Friendly
- âœ… 3 lines to get started
- âœ… Production defaults
- âœ… Type-safe APIs
- âœ… Comprehensive errors

### 3. Enterprise Ready
- âœ… Cryptographic proofs
- âœ… Compliance logging
- âœ… Policy enforcement
- âœ… Multi-tenancy

### 4. Collaborative
- âœ… Agent delegation
- âœ… Authority chains
- âœ… Capability scoping
- âœ… Revocation

---

**ArmorIQ SDK v0.1.1** - Visual Architecture Guide  
**January 16, 2026**
